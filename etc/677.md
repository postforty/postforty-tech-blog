# Pandoc: 범용 문서 변환기의 필수 사용법

## 1\. Pandoc이란 무엇인가?

### 1-1. Pandoc의 정의와 역할

Pandoc은 다양한 마크업 형식을 상호 변환하는 데 사용되는 **명령줄 기반의 오픈 소스 도구**이다. 이는 문서 변환 분야에서 **'문서 변환의 스위스 군용 칼'**로 불린다.

**주요 기능**:

- Markdown, HTML, LaTeX, DOCX, ODT, EPUB, Textile, reStructuredText 등 수십 가지 문서 형식 간의 상호 변환을 지원한다.
- 특히 Markdown으로 작성된 문서를 Word나 PDF와 같은 전문적인 출력물로 변환하는 데 강력하다.

### 1-2. 설치의 필요성

Pandoc은 별도의 그래픽 사용자 인터페이스(GUI)를 제공하지 않으며, **명령줄 환경**에서 작동한다. 따라서 이를 사용하기 위해서는 반드시 사용자의 시스템 환경에 직접 설치해야 한다.

**운영 체제별 설치 예시**

- macOS (Homebrew 사용):

```bash
brew install pandoc
```

- Windows (Chocolatey 사용):

```bash
choco install pandoc
```

- Linux (Debian/Ubuntu 계열):

```bash
sudo apt-get install pandoc
```

## 2\. 기본 변환 명령어와 핵심 옵션

Pandoc의 기본 사용 문법은 `pandoc [입력 파일] -o [출력 파일]` 형식이다. Pandoc은 파일 확장자를 통해 입력 및 출력 형식을 자동으로 추론한다.

### 2-1. 핵심 옵션: `-o` (출력 파일 지정)

`-o` 옵션은 \*\*출력 파일(`--output`)\*\*을 지정하는 옵션이다. 이는 변환된 결과물을 사용자가 지정한 이름과 경로의 파일로 저장하도록 지시하는 역할을 수행한다.

**`-o` 옵션의 기능**:

- `-o` 옵션을 **지정하지 않았을 경우**, 변환된 결과는 터미널 화면인 \*\*표준 출력(`stdout`)\*\*으로 출력된다.
- `-o` 옵션을 **지정했을 경우**, 변환된 결과는 지정된 **파일**에 저장된다.

**사용 예시**:

```bash
pandoc input.md -o output.docx
```

이 명령어는 `input.md` 파일을 읽어 변환한 뒤, 그 결과를 `output.docx`라는 **파일로 저장**하도록 지시하는 것이다.

### 2-2. 단일 파일 변환 (Markdown to DOCX)

`Markdown` 파일을 `Microsoft Word` 형식(`DOCX`)으로 변환하는 기본 명령어이다.

**기본 변환 명령어**:

```bash
pandoc document.md -o document.docx
```

이 명령은 `document.md`의 내용을 `document.docx`로 변환한다.

**입력/출력 형식 명시**:

```bash
pandoc -f markdown -t docx document.md -o document.docx
```

`-f` (from) 옵션과 `-t` (to) 옵션을 사용하여 입력 및 출력 형식을 명시적으로 지정할 수도 있다.

### 2-3. PDF 파일로의 변환

`PDF`로 변환하기 위해서는 `LaTeX` 엔진이 시스템에 설치되어 있어야 한다. `Pandoc`은 `LaTeX`을 중간 형식으로 사용하여 `PDF`를 생성한다.

**PDF 변환 명령어**:

```bash
pandoc document.md -o document.pdf
```

## 3\. 고급 사용법: 일괄 처리 및 템플릿 적용

### 3-1. 다수 파일 일괄 변환

현재 디렉터리의 모든 `.md` 파일을 `.docx` 파일로 일괄 변환하는 명령어이다.

**Linux/macOS (Bash/Zsh)**:

```bash
for i in *.md; do pandoc "$i" -o "${i%.md}.docx"; done
```

**Windows (CMD - 명령 프롬프트에 직접 입력)**:

```cmd
for %f in (*.md) do (pandoc "%f" -o "%~nf.docx")
```

### 3-2. 서식 유지를 위한 참조 문서 사용

`DOCX` 파일로 변환 시, `Word` 문서의 스타일(글꼴, 크기, 제목 스타일 등)을 그대로 유지하려면 참조 문서(`reference-doc`)를 사용해야 한다.

**참조 문서 지정 명령어**:

```bash
pandoc document.md --reference-doc=custom-template.docx -o document-styled.docx
```

#### 3-2-1. 참조 문서의 역할

참조 문서는 `Pandoc`이 내부적으로 사용하는 기본 스타일을 덮어쓰기 위해 사용된다. 사용자는 `Word`에서 원하는 스타일을 적용한 빈 `DOCX` 파일을 생성하여 이를 참조 문서로 활용하는 것이 일반적이다.

**주요 스타일 요소**:

- **제목**: Heading 1, Heading 2 등의 스타일을 정의한다.
- **본문**: Normal 스타일을 정의한다.
- **코드**: Code Block 스타일 등을 정의한다.
