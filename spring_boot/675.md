# VSCode에서 Gradle 빌드 오류 해결 보고서

## 1\. Gradle 빌드 실패: 'Unsupported class file major version 65' 오류 분석

### 1-1. 오류 발생 현상 및 원인 분석

VSCode에서 Spring Boot 프로젝트를 열었는데 좌측 하단에 `Java: Error`가 표시되어 프로젝트가 정상적으로 동작하지 않았다.
Gradle 프로젝트 빌드 과정에서 **Java 버전 비호환성**으로 인해 치명적인 오류가 발생한 것이다. 핵심 오류 메시지는 `Unsupported class file major version 65`이다.

- **Major Version 65의 의미**

  - Java 클래스 파일의 **Major Version 65**는 **Java 21** 버전에 해당한다.
  - 빌드 환경에서 Java 21이 사용되고 있음을 의미한다.

- **버전 충돌의 근거**

  - 빌드 로그에 명시된 **Gradle 버전은 6.4.1**이다.
  - Gradle 6.4.1은 출시 시점을 기준으로 **Java 14**까지만 공식적으로 지원하는 버전이다.
  - 하위 버전의 Gradle이 상위 버전의 Java(Java 21)로 컴파일된 클래스 파일을 처리하려 할 때, 해당 파일 형식을 인식하지 못하여 `Unsupported` 오류가 발생하는 것이다.

#### 1-1-1. 로그를 통한 환경 확인

오류 로그에서 충돌하는 두 가지 핵심 환경 변수가 확인되었다.

- **확인된 Gradle 버전**

  ```
  [info] Gradle Version: 6.4.1
  ```

- **확인된 Java 실행 환경**

  ```
  [info] Java Home: C:\Users\dandycode\.vscode\extensions\redhat.java-1.46.0-win32-x64\jre\21.0.8-win32-x86_64
  ```

오류의 원인은 IDE(VS Code)에서 설정된 Java Language Server의 실행 환경(Java 21)이 Gradle 빌드에도 영향을 미쳐 발생한 **버전 미스매치**이다.

---

## 2\. 해결 방안: Gradle 실행 환경 격리 및 명시적 지정

### 2-1. Gradle 전용 Java Home 설정

가장 효과적인 해결책은 Gradle 빌드 시스템이 IDE 또는 전역 환경의 Java 설정에 의존하지 않고, **명시적으로 호환되는 JDK 버전을 사용하도록 강제**하는 것이다. Gradle 6.4.1과 호환되는 **Java 11**을 사용하도록 지정한다.

- **Gradle 속성 파일 수정**

  - 프로젝트의 루트 디렉토리에 있는 **`gradle.properties`** 파일을 수정한다.

  <!-- end list -->

  ```properties
  # gradle.properties 파일에 다음 설정을 추가한다.
  org.gradle.java.home=C:/Program Files/Java/jdk-11
  ```

  - 이 설정은 Gradle 데몬이 지정된 경로의 JDK를 사용하여 빌드를 실행하도록 명령한다. 이로써 `Unsupported class file major version 65` 오류가 해결된다.

### 2-2. 빌드 환경 최적화 설정 추가

해결과 더불어 프로젝트의 빌드 성능 및 일관성을 높이기 위해 다음과 같은 최적화 설정을 \*\*`gradle.properties`\*\*에 추가하는 것이 권장된다.

- **성능 관련 설정**

  ```properties
  # Gradle 데몬 활성화: 빌드 속도 향상
  org.gradle.daemon=true

  # 병렬 실행 활성화: 다중 모듈 프로젝트 빌드 시간 단축
  org.gradle.parallel=true

  # 빌드 캐싱 활성화: 이전 태스크 결과 재사용
  org.gradle.caching=true
  ```

---

## 3\. 결론 및 후속 조치

### 3-1. 문제 해결 확인 및 정리

`gradle.properties`에 `org.gradle.java.home`을 호환되는 Java 버전(예: Java 11)으로 명시함으로써, Gradle 6.4.1이 Java 21 클래스 파일을 읽지 못하는 문제를 성공적으로 해결하였다. 이는 **Gradle 버전 업그레이드 없이** 환경 충돌을 해결하는 실용적인 방법이다.

### 3-2. IDE 캐시 정리

Java 실행 환경 변경 후, IDE 내부에 잔존하는 빌드 정보로 인한 오류 발생 가능성을 제거한다.

- **VS Code 환경**

  - `Ctrl + Shift + P` 명령 팔레트를 실행한다.
  - **"Java: Clean Java Language Server Workspace"** 명령을 실행하여 Java 언어 서버의 워크스페이스 캐시를 정리한다.

- **프로젝트 문서화**

  - 팀원들과의 일관된 개발 환경 유지를 위해 프로젝트 README 등의 문서에 **필수 JDK 버전**과 **`gradle.properties`의 Java Home 설정**을 명시하는 것이 필수적이다.
